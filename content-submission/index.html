<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Submit Content | SchoolLinks Marketing Portal</title>
  <!-- Heap Analytics -->
  <script type="text/javascript">
    window.heapReadyCb=window.heapReadyCb||[],window.heap=window.heap||[],heap.load=function(e,t){window.heap.envId=e,window.heap.clientConfig=t=t||{},window.heap.clientConfig.shouldFetchServerConfig=!1;var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="https://cdn.us.heap-api.com/config/"+e+"/heap_config.js";var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(a,r);var n=["init","startTracking","stopTracking","track","resetIdentity","identify","getSessionId","getUserId","getIdentity","addUserProperties","addEventProperties","removeEventProperty","clearEventProperties","addAccountProperties","addAdapter","addTransformer","addTransformerFn","onReady","addPageviewProperties","removePageviewProperty","clearPageviewProperties","trackPageview"],i=function(e){return function(){var t=Array.prototype.slice.call(arguments,0);window.heapReadyCb.push({name:e,fn:function(){heap[e]&&heap[e].apply(heap,t)}})}};for(var p=0;p<n.length;p++)heap[n[p]]=i(n[p])};
    heap.load("262759952");
  </script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="page-layout">
    <!-- Compact Header -->
    <header class="header">
      <div class="header-inner">
        <div class="logo">
          <img src="assets/schoolinks-logo-white.png" alt="SchooLinks" class="logo-image">
        </div>
        <span class="header-divider">|</span>
        <span class="header-subtitle">Content Submission</span>
        <nav class="header-nav">
          <button class="nav-tab active" data-tab="submit" onclick="switchTab('submit')">Submit Content</button>
          <button class="nav-tab" data-tab="reports" onclick="switchTab('reports')">Reports</button>
          <button class="nav-tab" data-tab="edit" onclick="switchTab('edit')">Edit Content</button>
        </nav>
      </div>
    </header>

    <!-- Success Message (Hidden by default) -->
    <div id="success-message" class="success-message hidden">
      <div class="success-icon">âœ…</div>
      <h2>Content Submitted!</h2>
      <p>Your content has been added to the marketing portal.</p>
      <button onclick="resetForm()" class="btn btn-primary">Submit Another</button>
    </div>

    <!-- Main Content - Two Column Layout -->
    <main id="main-content" class="main-content">
      <!-- Left Column: AI Assistant -->
      <section class="ai-panel">
        <div class="ai-assistant" id="ai-assistant">
          <div class="ai-header">
            <div class="ai-title">
              <span class="ai-icon">âœ¨</span>
              <h2>AI Assistant</h2>
            </div>
            <p class="ai-subtitle">Paste a URL or describe your content</p>
          </div>

          <div id="chat-messages" class="chat-messages">
            <!-- Messages appended here -->
          </div>

          <div class="chat-input-wrapper">
            <textarea
              id="ai-input"
              class="chat-input"
              placeholder="Paste a YouTube link, HubSpot URL, or describe the content..."
              rows="3"
            ></textarea>
            <div class="file-upload">
              <label class="file-label" for="ai-file">Upload PDF to auto-fill</label>
              <input id="ai-file" type="file" accept=".pdf,application/pdf">
            </div>
            <div class="input-actions">
              <button id="voice-btn" class="btn-icon btn-voice" type="button" title="Voice input">
                <span class="mic-icon">ðŸŽ¤</span>
              </button>
              <button id="parse-btn" class="btn btn-primary btn-parse" type="button">
                <span id="parse-text">Analyze</span>
                <span id="parse-loading" class="hidden">
                  <span class="spinner"></span>
                </span>
              </button>
            </div>
          </div>

          <!-- Preview Section -->
          <div id="preview-section" class="preview-section hidden">
            <div class="preview-header">
              <h3>Extracted Data</h3>
              <span class="preview-hint">Edit before applying</span>
            </div>
            <div id="preview-fields" class="preview-fields"></div>
            <div class="preview-actions">
              <button id="apply-fields" class="btn btn-primary" type="button">Apply to Form</button>
              <button id="clear-preview" class="btn btn-ghost" type="button">Clear</button>
            </div>
          </div>
        </div>
      </section>

      <!-- Right Column: Form -->
      <section class="form-panel">
        <form id="content-form" class="content-form">
          <!-- Row 1: Type & Platform -->
          <div class="form-row">
            <div class="form-group">
              <label for="type">Content Type *</label>
              <select id="type" name="type" required>
                <option value="">Select...</option>
                <option value="Blog">Blog</option>
                <option value="Video">Video</option>
                <option value="Video Clip">Video Clip</option>
                <option value="Customer Story">Customer Story</option>
                <option value="1 Pager">1 Pager</option>
                <option value="Ebook">Ebook</option>
                <option value="Webinar">Webinar</option>
                <option value="Press Release">Press Release</option>
                <option value="Award">Award</option>
                <option value="Landing Page">Landing Page</option>
                <option value="Asset">Asset</option>
              </select>
            </div>
            <div class="form-group">
              <label for="platform">Platform *</label>
              <select id="platform" name="platform" required>
                <option value="">Select...</option>
                <option value="Website">Website</option>
                <option value="YouTube">YouTube</option>
                <option value="LinkedIn">LinkedIn</option>
                <option value="HubSpot">HubSpot</option>
                <option value="Email">Email</option>
                <option value="Social Media">Social Media</option>
                <option value="Other">Other</option>
              </select>
            </div>
          </div>

          <!-- Row 2: Title -->
          <div class="form-group">
            <label for="title">Title *</label>
            <input type="text" id="title" name="title" placeholder="Content title" required>
          </div>

          <!-- Row 3: Links -->
          <div class="form-row">
            <div class="form-group">
              <label for="live_link">Live Link *</label>
              <input type="url" id="live_link" name="live_link" placeholder="https://schoolinks.com/..." required>
            </div>
            <div class="form-group">
              <label for="ungated_link">Ungated Link</label>
              <input type="url" id="ungated_link" name="ungated_link" placeholder="Direct download URL">
            </div>
          </div>

          <!-- Row 4: State & Tags -->
          <div class="form-row">
            <div class="form-group">
              <label for="state">State/Region</label>
              <select id="state" name="state">
                <option value="">National</option>
                <option value="National">National</option>
                <option value="AL">Alabama</option>
                <option value="AK">Alaska</option>
                <option value="AZ">Arizona</option>
                <option value="AR">Arkansas</option>
                <option value="CA">California</option>
                <option value="CO">Colorado</option>
                <option value="CT">Connecticut</option>
                <option value="DE">Delaware</option>
                <option value="FL">Florida</option>
                <option value="GA">Georgia</option>
                <option value="HI">Hawaii</option>
                <option value="ID">Idaho</option>
                <option value="IL">Illinois</option>
                <option value="IN">Indiana</option>
                <option value="IA">Iowa</option>
                <option value="KS">Kansas</option>
                <option value="KY">Kentucky</option>
                <option value="LA">Louisiana</option>
                <option value="ME">Maine</option>
                <option value="MD">Maryland</option>
                <option value="MA">Massachusetts</option>
                <option value="MI">Michigan</option>
                <option value="MN">Minnesota</option>
                <option value="MS">Mississippi</option>
                <option value="MO">Missouri</option>
                <option value="MT">Montana</option>
                <option value="NE">Nebraska</option>
                <option value="NV">Nevada</option>
                <option value="NH">New Hampshire</option>
                <option value="NJ">New Jersey</option>
                <option value="NM">New Mexico</option>
                <option value="NY">New York</option>
                <option value="NC">North Carolina</option>
                <option value="ND">North Dakota</option>
                <option value="OH">Ohio</option>
                <option value="OK">Oklahoma</option>
                <option value="OR">Oregon</option>
                <option value="PA">Pennsylvania</option>
                <option value="RI">Rhode Island</option>
                <option value="SC">South Carolina</option>
                <option value="SD">South Dakota</option>
                <option value="TN">Tennessee</option>
                <option value="TX">Texas</option>
                <option value="UT">Utah</option>
                <option value="VT">Vermont</option>
                <option value="VA">Virginia</option>
                <option value="WA">Washington</option>
                <option value="WV">West Virginia</option>
                <option value="WI">Wisconsin</option>
                <option value="WY">Wyoming</option>
              </select>
            </div>
            <div class="form-group">
              <label for="tags">Tags</label>
              <input type="text" id="tags" name="tags" placeholder="college, career, students">
            </div>
          </div>

          <!-- Row 5: Summary -->
          <div class="form-group">
            <label for="summary">Summary *</label>
            <textarea id="summary" name="summary" rows="3" placeholder="Brief description (2-3 sentences)" required></textarea>
          </div>

          <!-- Submit -->
          <div class="form-actions">
            <button type="submit" class="btn btn-primary btn-submit">
              <span id="submit-text">Submit Content</span>
              <span id="submit-loading" class="hidden">
                <span class="spinner"></span> Submitting...
              </span>
            </button>
          </div>
        </form>
      </section>
    </main>

    <!-- Reports Section (Hidden by default) -->
    <section id="reports-section" class="reports-section hidden">
      <div class="reports-container">
        <h2>Submission Reports</h2>
        <p class="reports-subtitle">View content submissions by time period with type and platform breakdowns</p>

        <div class="reports-filters">
          <div class="quick-filters">
            <button class="quick-filter-btn active" onclick="loadReportPeriod('last30')">Last 30 Days</button>
            <button class="quick-filter-btn" onclick="loadReportPeriod('annual')">This Year</button>
            <button class="quick-filter-btn" onclick="loadReportPeriod('all')">All Time</button>
          </div>
          <div class="custom-filter">
            <span class="filter-label">Custom:</span>
            <input type="date" id="report-date-from" class="date-input">
            <span>to</span>
            <input type="date" id="report-date-to" class="date-input">
            <button class="btn btn-sm" onclick="loadReport()">Apply</button>
          </div>
          <button id="export-csv-btn" class="btn btn-ghost" onclick="exportReportCSV()" disabled>
            ðŸ“¥ Export CSV
          </button>
        </div>

        <div class="reports-summary" id="reports-summary">
          <!-- Summary stats appear here -->
        </div>

        <div class="reports-breakdown" id="reports-breakdown">
          <!-- Type/Platform/State breakdown appears here -->
        </div>

        <div class="reports-table-wrapper">
          <table class="reports-table" id="reports-table">
            <thead>
              <tr>
                <th>Submitted</th>
                <th>Type</th>
                <th>Title</th>
                <th>State</th>
                <th>Platform</th>
                <th>Link</th>
              </tr>
            </thead>
            <tbody id="reports-tbody">
              <tr class="empty-row">
                <td colspan="6">Click a time period above to load submissions</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- Edit Content Section (Hidden by default) -->
    <section id="edit-section" class="edit-section hidden">
      <div class="edit-container">
        <h2>Edit Content</h2>
        <p class="edit-subtitle">Search, edit, or delete content from the database</p>

        <div class="edit-search">
          <input type="text" id="edit-search-input" placeholder="Search by title, type, or tags..." class="search-input">
          <select id="edit-type-filter" class="filter-select">
            <option value="">All Types</option>
            <option value="Blog">Blog</option>
            <option value="Video">Video</option>
            <option value="Video Clip">Video Clip</option>
            <option value="Customer Story">Customer Story</option>
            <option value="1 Pager">1 Pager</option>
            <option value="Ebook">Ebook</option>
            <option value="Webinar">Webinar</option>
            <option value="Press Release">Press Release</option>
            <option value="Award">Award</option>
            <option value="Landing Page">Landing Page</option>
            <option value="Asset">Asset</option>
          </select>
          <button class="btn btn-primary" onclick="searchContent()">Search</button>
        </div>

        <div class="edit-results" id="edit-results">
          <p class="edit-hint">Enter a search term or select a type filter to find content</p>
        </div>
      </div>
    </section>

    <!-- Edit Modal -->
    <div id="edit-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Edit Content</h3>
          <button class="modal-close" onclick="closeEditModal()">Ã—</button>
        </div>
        <form id="edit-form" onsubmit="saveContentEdit(event)">
          <input type="hidden" id="edit-id">
          <div class="form-row">
            <div class="form-group">
              <label for="edit-type">Type</label>
              <select id="edit-type" name="type" required>
                <option value="Blog">Blog</option>
                <option value="Video">Video</option>
                <option value="Video Clip">Video Clip</option>
                <option value="Customer Story">Customer Story</option>
                <option value="1 Pager">1 Pager</option>
                <option value="Ebook">Ebook</option>
                <option value="Webinar">Webinar</option>
                <option value="Press Release">Press Release</option>
                <option value="Award">Award</option>
                <option value="Landing Page">Landing Page</option>
                <option value="Asset">Asset</option>
              </select>
            </div>
            <div class="form-group">
              <label for="edit-platform">Platform</label>
              <select id="edit-platform" name="platform">
                <option value="Website">Website</option>
                <option value="YouTube">YouTube</option>
                <option value="LinkedIn">LinkedIn</option>
                <option value="HubSpot">HubSpot</option>
                <option value="Email">Email</option>
                <option value="Social Media">Social Media</option>
                <option value="Other">Other</option>
              </select>
            </div>
          </div>
          <div class="form-group">
            <label for="edit-title">Title</label>
            <input type="text" id="edit-title" name="title" required>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="edit-live-link">Live Link</label>
              <input type="url" id="edit-live-link" name="live_link">
            </div>
            <div class="form-group">
              <label for="edit-ungated-link">Ungated Link</label>
              <input type="url" id="edit-ungated-link" name="ungated_link">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="edit-state">State</label>
              <input type="text" id="edit-state" name="state" placeholder="e.g., TX, CA">
            </div>
            <div class="form-group">
              <label for="edit-tags">Tags</label>
              <input type="text" id="edit-tags" name="tags">
            </div>
          </div>
          <div class="form-group">
            <label for="edit-summary">Summary</label>
            <textarea id="edit-summary" name="summary" rows="3"></textarea>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn btn-danger" onclick="deleteContent()">Delete</button>
            <div class="modal-actions-right">
              <button type="button" class="btn btn-ghost" onclick="closeEditModal()">Cancel</button>
              <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal hidden">
      <div class="modal-content modal-sm">
        <div class="modal-header">
          <h3>Confirm Delete</h3>
          <button class="modal-close" onclick="closeDeleteModal()">Ã—</button>
        </div>
        <p>Are you sure you want to delete "<span id="delete-title"></span>"?</p>
        <p class="delete-warning">This action cannot be undone.</p>
        <div class="modal-actions">
          <button class="btn btn-ghost" onclick="closeDeleteModal()">Cancel</button>
          <button class="btn btn-danger" onclick="confirmDelete()">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
  <script src="config.js"></script>
  <script src="ai-assistant.js"></script>
  <script src="app.js"></script>
</body>
</html>
